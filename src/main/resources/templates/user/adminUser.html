<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<h1>상세정보 조회</h1>


    <form th:action="@{'/admin/' + ${user.userId}}" method="POST" th:object="${user}">
        <div>
            <label>UID</label>
            <input type="text" name="userId" disabled th:value="*{userId}">
        </div>
        <div>
            <label>이메일</label>
            <input type="text" name="email" disabled th:value="*{email}">
        </div>
        <div>
            <label>닉네임</label>
            <input type="text" name="nickname" class="input-field" pattern="^(?=.*[0-9])(?=.*[a-zA-Z])[0-9a-zA-Z]{,10}$" required maxlength="10" th:value="*{nickname}">
        </div>
        <div>
            <label>가입일</label>
            <input type="text" name="createdAt" disabled th:value="*{createdAt}">
        </div>
        <div>
            <label>탈퇴일</label>
            <input type="text" name="deletedAt" disabled th:value="*{deletedAt}">
        </div>
        <div>
            <label for="role">회원등급</label>
            <select name="role" id="role" th:field="*{role}">
                <option value="JUNIOR" th:selected="*{role == 'JUNIOR'}">JUNIOR</option>
                <option value="SENIOR" th:selected="*{role == 'SENIOR'}">SENIOR</option>
            </select>
        </div>
        <button type="submit" class="btn-update" disabled onclick="update()">변경사항 저장</button>
        <button type="button" class="btn-close" onclick="closePopup()">닫기</button>
    </form>

    <script>
        const userForm = document.querySelector('form')
        const updateBtn = document.querySelector('.btn-update')
        const inputField = document.querySelector('.input-field')
        const selectRole = document.querySelector('select')

        function update() {
            userForm.submit();
        }

        function closePopup() {
            window.close();
        }

        inputField.addEventListener('input', () => {
            updateBtn.removeAttribute('disabled');
        })

        selectRole.addEventListener('change', () => {
            updateBtn.removeAttribute('disabled');
        })

        window.addEventListener('beforeunload', () => {
            opener.parent.location.reload();
        })
    </script>
</body>
</html>